<div class="flex h-screen overflow-hidden">
  <app-menu-lateral (menuToggled)="onMenuToggle($event)" class="z-20"></app-menu-lateral>
  
  <div class="flex-1 flex flex-col overflow-hidden">
    <!-- Notification bar -->
    <div class="alert-container">
      <app-global-alerta></app-global-alerta>
    </div>

    <main class="flex-1 overflow-x-hidden overflow-y-auto transition-all duration-300"
          [ngClass]="{'ml-0': isMenuOpen, 'ml-': !isMenuOpen}">
      <div class="container mx-auto px-4 py-8">
        <h1 class="p-4 text-2xl font-bold custom-font custom-color">Control de monitoreo</h1>
        
        <!-- Lote selection -->
        <div class="mb-4 shadow-md">
          <app-lotes [monitoreoData]="monitoreoData" (loteSeleccionado)="onLoteChange($event)"></app-lotes>
        </div>

        <h2 class="text-xl font-semibold text-gray-800 mb-2">Gráfica general</h2>
        <div class="flex flex-wrap mt-4">
          <!-- Left column: Cards (35%) -->
          <div class="w-full lg:w-[35%] pr-0 lg:pr-4 mb-4 lg:mb-0">
          
            <div class="grid grid-cols-2 gap-4 mb-4">
              <app-cards-info
                title="Temperatura"
                [value]="temperaturaValue"
                [trend]="temperaturaTrend"
                [trendValue]="temperaturaTrendValue"
                [status]="temperaturaStatus"
                [isTimeCard]="false">
              </app-cards-info>
              <app-cards-info
                title="TDS"
                [value]="tdsValue"
                [trend]="tdsTrend"
                [trendValue]="tdsTrendValue"
                [status]="tdsStatus"
                [isTimeCard]="false">
              </app-cards-info>
              <app-cards-info
                title="pH"
                [value]="phValue"
                [trend]="phTrend"
                [trendValue]="phTrendValue"
                [status]="phStatus"
                [isTimeCard]="false">
              </app-cards-info>
              <app-cards-info
                title="ÚLTIMO REGISTRO"
                [value]="ultimoRegistroHora"
                [trendValue]="penultimoRegistroHora"
                [status]="'unassigned'"
                [isTimeCard]="true">
              </app-cards-info>
            </div>
          </div>
          
          <!-- Right column: General Graph (65%) -->
          <div class="w-full lg:w-[65%]">
            <div class="mb-8">
              <app-grafica [data]="monitoreoDataFiltrada" [selectedLote]="selectedLote"></app-grafica>
            </div>
          </div>
        </div>

        <!-- Bar Graph (below two columns) -->
        <!-- Alert History -->
        <div class="mt-8">
          <h2 class="text-xl font-semibold text-gray-800 mb-2">Historial de alertas</h2>
          <app-fechas-mensajes [alertasFiltradas]="alertasFiltradas"></app-fechas-mensajes>
        </div>
      </div>
    </main>
  </div>
</div>